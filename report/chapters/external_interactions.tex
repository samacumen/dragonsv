% External requirements table with actions/ variables/ sync_comm.
\label{sec:ext_interactions}
This section lists the interactions used for the packet storage system. Interactions are described by actions that are essential for the controllers to communicate between each other and with the the physical world. The following describe in brief the external and internal interactions used in the system; the action, it parameters and its description.

\subsection*{External Interactions} These actions are visible to the outside world or to the user controlling the system.

\begin{itemize}
\item \textbf{WantIn(id: packetID)}
Environment requires a packet with packet $id$ to be inserted into the system. This is action is controlled by controller C1.

\item \textbf{AcceptPacket(id: packetID)}
This action puts the packet on the conveyor belt received from the user. Controller C1 is responsible for initiating this action.

\item \textbf{RejectPacket(id: packetID)}
This action informs the user that the packet with $id$ cannot be accepted by the system. This is governed by controller C1.

\item \textbf{MoveElevator(eId: elevID, p: pos)}
This action is initiated by controllers C3 or C4 to instruct the real hardware to move its elevator with the corresponding id $eId$ to the target position $p$.

\item \textbf{WantOut(id: packetID)}
User requests the packet with an $id$ to be delivered by the system. This action is initiated by controller C2.

\item \textbf{DeliverPacket(id: packetID)}
Controller C2 initiates DeliverPacket action to deliver the request packet $id$.

\item \textbf{ConvInToElev(eId: elevID)}
With this action, controller C1 instructs the hardware to transfer the packet from input conveyor to the required elevator.

\item \textbf{RackToElev(eId: elevID, rId: rackID)}
Controller C5 instructs the hardware to transfer the packet from rack to the required elevator.

\item \textbf{ElevToRack(eId: elevID, rId: rackID)}
Controller C3 or C4 instruct the hardware to transfer the packet from elevator to the rack.

\item \textbf{ElevToConvOut(eId: elevID)}
Controllers C3 or C4 instructs its hardware to transfer the packet from the required elevator platform to the output conveyor.
%What will happen if we give the elevID to be 1.. it would deadlock?%

\end{itemize}

\subsection*{Internal interactions}
The internal interactions are listed below. These actions are hidden to the outside world or the user controlling the system and take place as interactions within/between individual controllers.

\begin{itemize}
\item \textbf{queryRackSpace(b: bool)}
Queries controller C5 if a position is available on the racks. This is an internal action that is initiated by controller C1.
%Should it be a communication??%

\item \textbf{commPacketOnInConveyor(id: packetID)}
This is a synchronizing action whereby controller C1 informs C5 of the packet on the conveyor. This action is completed with the acknowledgement from controller C5.

\item \textbf{commOrderMoveElevator(eId: elevID, p: pos)}
Controller C5 synchronizes with an elevator controller (C3/C4) to move it to a target position $p$.

\item \textbf{commAckElevMoved(b: bool)}
Elevator controller acknowledges controller C5 of the completion of elevator movement.

\item \textbf{commConveyorToElev(eId: elevID, cId: convID)}
Controller C5 informs C1 to move the conveyor belt and exchange the packet with the elevator with a given $elevID$.

\item \textbf{commPacketOnElevAck(id: packetID)}
Elevator controllers acknowledge controller C5 once packet is received by the elevator.

\item \textbf{commElevToRack(eId: elevID)}
Controller C5 communicates with elevator controllers in order to load to packet to the rack.

\item \textbf{commPacketLoadedToRack(id: packetID)}
Elevator controllers inform controller C5 that loading of the packet to the rack action is completed.

\item \textbf{commRequestPacket(id: packetID)}
A synchronization action between controllers C2 and C5 to request a packet with a given $id$.

\item \textbf{commPacketExists(b: bool)}
Synchronization action that gains the knowledge of the packet availability from rack controller C5 to C1.

\item \textbf{commRackToElev(eId: elevID)}
This action indicates the synchronization of reception of packet by the rack.

\item \textbf{commElevToConveyor(eId: elevID)}
This action indicates the communication of unloading a packet to the conveyor belt.

\item \textbf{commElevToRack(eId: elevID)}
Elevator communication with controller C5 after an outgoing transaction is complete.
\end{itemize}

\subsection*{Data types}
The data types used are described in table \ref{tab: data_types}.
\begin{table}[h]
\centering
\begin{tabular}{|l|l|l|}\hline
Datatype & OfType & Range$\slash$Members\\\hline
packetID & $Nat+$ & { 1..N} \\\hline
elevID & $Nat+$ & { 1, 2}\\\hline
rackID & $Nat+$ & { 1, numRack}\\\hline
pos & $Int$ & {-1, numRack}\\\hline
b & $bool$ & {true, false} \\\hline
\end{tabular}
\caption{Data types in our design: Packet storage system }
\label{tab: data_types}
\end{table}

\textit{Note: The $numRack$ in the system is a constant and can be chosen for the given design.}
